--USP_LIST_OF_INVOICE_V1 1,10,'0','0','','0','0','0','0','ASC',''
--GO
--USP_LIST_OF_INVOICE_RPT 1,0,'0','0','','0','0','0','0','ASC',''

--SELECT i.id,i.invoice_no,c.name,i.tamount,i.invsendDt, CASE WHEN i.Sent = 0 THEN 'NO' ELSE 'YES' END As Sent--	, i.SendMode,i.Emailed,CASE WHEN i.FullPayment = 0 THEN 'NO' ELSE 'Yes' END As FullPayment--	, COUNT(1) OVER() As TotalInvoice--FROM invoiceList i --	INNER JOIN Company c on i.CID = c.Id --WHERE i.invalid = 0-- And c.BlackListed=0--ORDER BY c.name,i.invsendDt ASC  offset 0 rows fetch  next 10 rows only--SELECT i.id,i.invoice_no,c.name,i.tamount,i.invsendDt,CASE WHEN i.Sent = 0 THEN 'NO' ELSE 'YES' END As Sent,i.SendMode,i.Emailed,CASE WHEN i.FullPayment = 0 THEN 'NO' ELSE 'Yes' END As FullPayment, COUNT(1) OVER() As TotalInvoice --FROM invoiceList I --	INNER JOIN Company C on I.CID = C.Id --	--INNER JOIN Sales S ON C.ID = S.CID--	--LEFT JOIN vSalesPerson SP ON S.SalesPerson = SP.SalesPersonID--WHERE i.invalid = 0-- And c.Address LIKE '%Gulshan%'-- And c.BlackListed=0--ORDER BY c.name,i.invsendDt ASC  offset 0 rows fetch  next 100 rows only;WITH InvoiceList_CTE As(	SELECT DISTINCT SC.Invoice_Id, SP.SalesPersonName	FROM invoiceSceduler SC		LEFT JOIN Sales S ON S.TNO = SC.TNO		LEFT JOIN vSalesPerson SP ON S.SalesPerson = SP.SalesPersonID)SELECT i.id, i.invoice_no, c.name, i.tamount, i.invsendDt, CASE WHEN i.Sent = 0 THEN 'NO' ELSE 'YES' END As Sent	, i.SendMode,i.Emailed,CASE WHEN i.FullPayment = 0 THEN 'NO' ELSE 'Yes' END As FullPayment	, COUNT(1) OVER() As TotalInvoice	--, IL.SalesPersonNameFROM invoiceList i 	LEFT JOIN Company c on i.CID = c.Id 	--LEFT JOIN InvoiceList_CTE IL ON i.ID = IL.Invoice_IdWHERE i.invalid = 0	And c.BlackListed=1	--And c.Address LIKE '%Gulshan%' --And i.ID in (443354,393310)ORDER BY c.name,i.invsendDt ASC  offset 0 rows fetch  next 10 rows only--select * from invoiceList--where ID in (443354,393310)--select * from invoiceSceduler--where Invoice_Id in (443354,393310)USP_LIST_OF_INVOICE_V1 1,10,'0','0','>=','10','0','2','1','ASC','gulshan', 286USP_LIST_OF_INVOICE 1,10,'0','0','','0','0','0','0','ASC',''USP_LIST_OF_INVOICE_RPT 1,10,'0','0','','0','0','0','0','ASC',''USP_LIST_OF_INVOICE_V1 1,10,'','0','','0','0','0','0','ASC','', 7;WITH InvoiceList_CTE As(	SELECT DISTINCT SC.Invoice_Id, SP.SalesPersonName, c.name As CompanyName	FROM InvoiceList I		LEFT JOIN invoiceSceduler SC ON I.Id = SC.Invoice_Id		LEFT JOIN Sales S ON S.TNO = SC.TNO		LEFT JOIN vSalesPerson SP ON S.SalesPerson = SP.SalesPersonID		LEFT JOIN Company C on i.CID = C.IdWHERE I.invalid = 0 And C.BlackListed=0	--And I.id in(select i2.invoice_id from sales s Inner Join invoiceSceduler i2 on s.tno=i2.tno where i2.invoice_id=i.id and s.pcode = 74)	and s.pcode = 74 And SP.SalesPersonID = 7)SELECT i.id, i.invoice_no, IL.CompanyName, i.tamount, i.invsendDt, CASE WHEN i.Sent = 0 THEN 'NO' ELSE 'YES' END As Sent	, i.SendMode,i.Emailed,CASE WHEN i.FullPayment = 0 THEN 'NO' ELSE 'Yes' END As FullPayment	, COUNT(1) OVER() As TotalInvoice	, IL.SalesPersonNameFROM InvoiceList_CTE IL	LEFT JOIN invoiceList i ON i.ID = IL.Invoice_IdORDER BY IL.CompanyName,i.invsendDt ASC  offset 0 rows fetch  next 10 rows onlySELECT DISTINCT i.id,i.invoice_no,c.name,cp=(select top 1 cp.name from ContactPersons cp, invoicesceduler i2, sales s Where cp.Id = s.BillContactID And i2.TNO = s.TNO And i2.invoice_id = i.Id) ,c.phone,i.tamount,i.invsendDt,c.AccContactName, SP.SalesPersonNameFROM invoiceList i 	INNER JOIN company c on i.CID = c.Id 	LEFT JOIN Sales S ON S.CId = C.Id	LEFT JOIN vSalesPerson SP ON S.SalesPerson = SP.SalesPersonIDWHERE i.invalid = 0 --And c.Address LIKE '%%' And c.BlackListed=0ORDER BY c.name,i.invsendDt ASC --(165841 rows affected)